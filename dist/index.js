import{program as e}from"commander";import t from"node:process";import a from"inquirer";import i from"chalk";import r from"fs-extra";import o from"path";import s from"ora";import n from"handlebars";import m from"download-git-repo";const c={"react-javascript":"https://github.com/huanghu0/zb-react-template.git#main","react-typescript":"https://github.com/huanghu0/zb-reacte-template-ts.git#main","vue3-javascript":"https://github.com/huanghu0/zb-vue3-template.git#main","vue3-typescript":"https://github.com/huanghu0/zb-vue3-template-ts.git#main",vue2:"https://github.com/huanghu0/zb-vue2-template.git#main"};async function p(e,t,a){const c=s(i.blue("下载中"));c.color="blue",c.spinner={interval:80,frames:["|"]},c.start(),await m(`direct:${e}`,t,{clone:!0},(function(e){if(c.stop(),e)c.fail(i.red(`项目创建失败,${e}`));else{const e=o.resolve(t,"./package.json");if(r.existsSync(e)){const e=o.resolve(t,"./package.json"),s=r.readFileSync(e,"utf-8"),m=n.compile(s)(a);r.writeFileSync(e,m),c.succeed(i.green(`项目创建成功,请到./${a.name}文件夹下安装依赖并启动项目`))}}}))}async function u(e){const{name:i,version:s,author:n,df:m,dl:u}=e;let l="";l=u?c[`${m}-${u}`]:c[m];let h=l.trim(),f=o.resolve(t.cwd(),`./${i}`);const g={name:i,version:s,author:n};if(r.existsSync(f)){let e=await function(e){return a.prompt({type:"list",name:"isOverWrite",message:`当前目录已经存在${e}文件是否覆盖？`,choices:["yes","no"],default:"no"})}(i);"yes"===e.isOverWrite&&(await r.emptyDir(f),p(h,f,g))}else p(h,f,g)}e.command("create <name>").action((async e=>{try{let t=await a.prompt([{type:"input",name:"version",message:i.yellow("请输入项目版本号？"),default:"1.0.0"},{type:"input",name:"author",message:i.gray("请输入项目作者？"),default:""},{type:"list",name:"df",message:"请选择开发框架？",choices:["react","vue2","vue3"],default:"react"}]),r={};"vue2"!==t.df&&(r=await a.prompt([{type:"list",name:"dl",message:"请选择开发语言？",choices:["javascript","typescript"],default:"javascript"}])),await u({name:e,...t,...r})}catch(e){return void console.log(e.message)}})),e.parse(t.argv);
